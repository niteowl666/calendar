<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Calendar GIF</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="/style.css">
</head>
<style>

</style>
<body>
    <div class="position-relative">
        <div id="carouselExample" class="carousel slide">
            <div class="carousel-inner">
              <div class="carousel-item active">
                <div class="bg-dark d-flex justify-content-center align-items-center" style="height: 100vh;">
                    <div class="calendar">
                        <video autoplay muted playsinline loop class="calendar-gif">
                            <source src="/assets/1.mp4"  type="video/mp4" />
                        </video>
                    </div>
                </div>
              </div>
              <div class="carousel-item" id="0">
                <div class="bg-dark d-flex justify-content-center align-items-center" style="height: 100vh;">
                    <div class="calendar">
                        <video autoplay muted playsinline loop class="calendar-gif">
                            <source src="./assets/2.mp4"  type="video/mp4" />
                        </video>
                        <div id="calendar-0" class="calendar-grid"></div>
                    </div>
                </div>
              </div>
              <div class="carousel-item" id="1">
                <div class="bg-dark d-flex justify-content-center align-items-center" style="height: 100vh;">
                    <div class="calendar">
                        <video autoplay muted playsinline loop class="calendar-gif">
                            <source src="./assets/3.mp4"  type="video/mp4" />
                        </video>
                        <div id="calendar-1" class="calendar-grid"></div>
                    </div>
                </div>
              </div>
              <div class="carousel-item" id="2">
                <div class="bg-dark d-flex justify-content-center align-items-center" style="height: 100vh;">
                    <div class="calendar">
                        <video autoplay muted playsinline loop class="calendar-gif">
                            <source src="./assets/4.mp4"  type="video/mp4" />
                        </video>
                        <div id="calendar-2" class="calendar-grid"></div>
                    </div>
                </div>
              </div>
              <div class="carousel-item" id="3">
                <div class="bg-dark d-flex justify-content-center align-items-center" style="height: 100vh;">
                    <div class="calendar">
                        <video autoplay muted playsinline loop class="calendar-gif">
                            <source src="./assets/5.mp4"  type="video/mp4" />
                        </video>
                        <div id="calendar-3" class="calendar-grid"></div>
                    </div>
                </div>
              </div>
              <div class="carousel-item" id="4">
                <div class="bg-dark d-flex justify-content-center align-items-center" style="height: 100vh;">
                    <div class="calendar">
                        <video autoplay muted playsinline loop class="calendar-gif">
                            <source src="./assets/6.mp4"  type="video/mp4" />
                        </video>
                        <div id="calendar-4" class="calendar-grid"></div>
                    </div>
                </div>
              </div>
              <div class="carousel-item" id="5">
                <div class="bg-dark d-flex justify-content-center align-items-center" style="height: 100vh;">
                    <div class="calendar">
                        <video autoplay muted playsinline loop class="calendar-gif">
                            <source src="./assets/7.mp4"  type="video/mp4" />
                        </video>
                        <div id="calendar-5" class="calendar-grid"></div>
                    </div>
                </div>
              </div>
              <div class="carousel-item" id="6">
                <div class="bg-dark d-flex justify-content-center align-items-center" style="height: 100vh;">
                    <div class="calendar">
                        <video autoplay muted playsinline loop class="calendar-gif">
                            <source src="./assets/8.mp4"  type="video/mp4" />
                        </video>
                        <div id="calendar-6" class="calendar-grid"></div>
                    </div>
                </div>
              </div>
              <div class="carousel-item" id="7">
                <div class="bg-dark d-flex justify-content-center align-items-center" style="height: 100vh;">
                    <div class="calendar">
                        <video autoplay muted playsinline loop class="calendar-gif">
                            <source src="./assets/9.mp4"  type="video/mp4" />
                        </video>
                        <div id="calendar-7" class="calendar-grid"></div>
                    </div>
                </div>
              </div>
              <div class="carousel-item" id="8">
                <div class="bg-dark d-flex justify-content-center align-items-center" style="height: 100vh;">
                    <div class="calendar">
                        <video autoplay muted playsinline loop class="calendar-gif">
                            <source src="./assets/10.mp4"  type="video/mp4" />
                        </video>
                        <div id="calendar-8" class="calendar-grid"></div>
                    </div>
                </div>
              </div>
              <div class="carousel-item" id="9">
                <div class="bg-dark d-flex justify-content-center align-items-center" style="height: 100vh;">
                    <div class="calendar">
                        <video autoplay muted playsinline loop class="calendar-gif">
                            <source src="./assets/11.mp4"  type="video/mp4" />
                        </video>
                        <div id="calendar-9" class="calendar-grid"></div>
                    </div>
                </div>
              </div>
              <div class="carousel-item" id="10">
                <div class="bg-dark d-flex justify-content-center align-items-center" style="height: 100vh;">
                    <div class="calendar">
                        <video autoplay muted playsinline loop class="calendar-gif">
                            <source src="./assets/12.mp4"  type="video/mp4" />
                        </video>
                        <div id="calendar-10" class="calendar-grid"></div>
                    </div>
                </div>
              </div>
              <div class="carousel-item" id="11">
                <div class="bg-dark d-flex justify-content-center align-items-center" style="height: 100vh;">
                    <div class="calendar">
                        <video autoplay muted playsinline loop class="calendar-gif">
                            <source src="./assets/13.mp4"  type="video/mp4" />
                        </video>
                        <div id="calendar-11" class="calendar-grid"></div>
                    </div>
                </div>
              </div>
              <div class="carousel-item">
                <div class="bg-dark d-flex justify-content-center align-items-center" style="height: 100vh;">
                    <div class="calendar">
                        <video autoplay muted playsinline loop class="calendar-gif">
                            <source src="./assets/end.mp4"  type="video/mp4" />
                        </video>
                    </div>
                </div>
              </div>
            </div>
            <!-- <div class="position-relative"></div> -->
            <button class="carousel-control-prev" onclick="slideBtn(false)"  type="button"  data-bs-target="#carouselExample" data-bs-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            </button>
            <button class="carousel-control-next" onclick="slideBtn(true)" type="button" data-bs-target="#carouselExample" data-bs-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Next</span>
            </button>
          </div>
          <div id="calendarToast" class="toast align-items-center position-absolute" role="alert" aria-live="assertive" aria-atomic="true" data-bs-autohide="false">
            <div class="d-flex">
                <div class="toast-body">
                    Hello, world! This is a toast message.
                </div>
                <button type="button" class="btn-close me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
        </div>
    </div>
    <script>

    let mm
    let y = 2025;
    let days = 0;
    
    // Listen for the slide event to detect direction and trigger your function
    document.getElementById('carouselExample').addEventListener('slide.bs.carousel', function (event) {
        const direction = event.from < event.to ? 'next' : 'prev';
        // Call your custom function with the direction and target slide index

        onSlideChange(event.to, direction);
    });

    function onSlideChange(currentSlideIndex, direction) {
        mm = currentSlideIndex - 1
        displayCalendar(mm, y);
         days = getDaysInMonth(mm, y);
        // Add more actions based on the slide index or direction if needed
    }

const daysInMonth = {
            0: 31,
            1: 28, 
            2: 31,
            3: 30,
            4: 31,
            5: 30,
            6: 31,
            7: 31,
            8: 30,
            9: 31,
            10: 30,
            11: 31
        };

    
    function isLeapYear(year) {
        return (year % 4 === 0 && year % 100 !== 0) || (year % 400 === 0);
    }
    
    function getDaysInMonth(month, year) {
        if (month === 1 && isLeapYear(year)) {
            return 29;
        }
        return daysInMonth[month];
    }
    let monthCounter = -1

    function slideBtn(isNext) {

}

async function fetchHolidays(year) {
    const response = await fetch(`https://api-harilibur.netlify.app/api?year=2024`);
    const holidays = await response.json();
    return holidays;
}

// Example usage:
fetchHolidays(y).then(holidays => {
    // console.log(holidays, 'holidays');
});
function getDayOfWeek(date) {
    const daysOfWeek = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
    return daysOfWeek[date.getDay()]; // Get the day of the week
}

function getDaysInPreviousMonth(year, month) {
    return new Date(year, month, 0).getDate(); // Returns the last date of the previous month
}

function processDays(year) {
    const month = mm; // Current month from the slider
    const data = [];

    // Main days of the month
    for (let day = 1; day <= days; day++) {
        const date = new Date(year, month, day);
        const dayOfWeek = getDayOfWeek(date);

        data.push({
            timeStamp: date,
            day: dayOfWeek,
            date: date.getDate(),
            month: date.getMonth() + 1,
            year: date.getFullYear()
        });
    }

    // Fill the start of the month grid
    const firstDayIndex = new Date(year, month, 1).getDay();
    const previousMonthDays = getDaysInPreviousMonth(year, month);
    let daysToAddAtStart = (firstDayIndex === 0 ? 6 : firstDayIndex - 1);
    for (let i = 0; i < daysToAddAtStart; i++) {
        const date = new Date(year, month - 1, previousMonthDays - i);
        const dayOfWeek = getDayOfWeek(date);
        data.unshift({
            timeStamp: date,
            day: dayOfWeek,
            date: date.getDate(),
            month: date.getMonth() + 1,
            year: date.getFullYear()
        });
    }

    // Fill the end of the month grid
    const lastDayIndex = new Date(year, month, days).getDay();
    let daysToAddAtEnd = (lastDayIndex === 6 ? 0 : 6 - lastDayIndex);
    for (let i = 1; i <= daysToAddAtEnd; i++) {
        const date = new Date(year, month + 1, i);
        const dayOfWeek = getDayOfWeek(date);

        // Check for duplicates
        if (!data.some(d => d.date === date.getDate() && d.month === date.getMonth() + 1 && d.year === date.getFullYear())) {
            data.push({
                timeStamp: date,
                day: dayOfWeek,
                date: date.getDate(),
                month: date.getMonth() + 1,
                year: date.getFullYear()
            });
        }
    }

    // Ensure data has exactly 42 entries, filling with next month days as needed
    let start = 1;
    while (data.length < 42) {
        const date = new Date(year, month + 1, start);
        const dayOfWeek = getDayOfWeek(date);

        // Again check for duplicates
        if (!data.some(d => d.date === date.getDate() && d.month === date.getMonth() + 1 && d.year === date.getFullYear())) {
            data.push({
                timeStamp: date,
                day: dayOfWeek,
                date: date.getDate(),
                month: date.getMonth() + 1,
                year: date.getFullYear()
            });
        }
        start++;
    }

    return data;
}

function displayCalendar(month, year) {

    const calendarDiv = document.querySelector(`#calendar-${month}`);
    if (!calendarDiv) return
    calendarDiv.setAttribute('month', month)
    const days = processDays(y);
    calendarDiv.innerHTML = '';
    days.forEach(day => {
        const dayElement = document.createElement('div');
        dayElement.textContent = day.date;
        const formattedDate = day.timeStamp.toLocaleDateString('en-US', {
            weekday: 'long', 
            year: 'numeric', 
            month: 'long',  
            day: 'numeric'  
        });
        dayElement.setAttribute('date-val', formattedDate)
        dayElement.className = 'day'; // Add a class for styling
        calendarDiv.appendChild(dayElement);

        const toastElement = document.getElementById('calendarToast');
        const toastBootstrap = new bootstrap.Toast(toastElement);

        dayElement.addEventListener('click', (e) => {
            // Update the toast body with the clicked date
            const selectedDate = e.target.getAttribute('date-val');
            document.querySelector('#calendarToast .toast-body').textContent = `You clicked on ${selectedDate}`;

            // Show the toast
            toastBootstrap.show();
        });

    });

}

</script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>